% Copyright (c) 2024 Ludovic Lars
% This work is licensed under the CC BY-SA 4.0 International License

\documentclass[a5paper, 11pt]{book}

% Basic packages
\usepackage[polutonikogreek, french]{babel} % language
\usepackage[utf8]{inputenc}                 % accents
\usepackage[T1]{fontenc}                    % french characters
\usepackage[margin=2cm]{geometry}           % margin 
\usepackage{setspace}                       % spacing
\usepackage{graphicx}                       % images
\usepackage[font=small]{caption}            % custom caption
\usepackage{verbatim}                       % preformatted text
\usepackage{enumerate}                      % lists
\usepackage{hyperref}                       % cross-referencing
\usepackage{xurl}
\usepackage{enotez}                         % endnotes
\usepackage[backend=biber]{biblatex}        % bibliography

% Custom packages
\usepackage{newtxtext}                      % Times New Roman font
\usepackage{eurosym}                        % euro symbol
\usepackage{amsfonts,amsmath,amssymb,amsthm}    % math
\usepackage{xcolor}
\usepackage{fancyvrb}                       % fancy verbatim
\usepackage{seqsplit}
\usepackage{csquotes}
\usepackage[page]{pagenote}                 % pagenotes

\usepackage[type={CC}, modifier={by-sa}, version={4.0}]{doclicense} % license

% Custom settings
\setlength{\parskip}{1ex}                   % paragraph spacing
\renewenvironment{quote}{\small\list{}{\topsep=0.5\baselineskip}\item\relax}{\endlist} % quote spacing
\renewcommand{\arraystretch}{1.3}           % tabular spacing
\renewcommand\frenchtablename{Tableau}      % French name for table
\makepagenote
\renewcommand{\notenumintext}[1]{} % no mark for pagenotes
\renewcommand{\notenuminnotes}[1]{} % no number in pagenotes
\renewcommand{\notesname}{Notes supplémentaires} % pagenote chapter title
\renewcommand{\notedivision}{\chapter*{\notesname}} % remove pagenote chapter from toc

% Custom commands
\newcommand{\eng}[1]{{\NoAutoSpaceBeforeFDP\emph{#1}}}  % english
\newcommand{\wtime}[1]{{\NoAutoSpaceBeforeFDP#1}}       % datetime
\newcommand{\longstring}[1]{\texttt{\NoAutoSpaceBeforeFDP\seqsplit{#1}}}
\newcommand{\sendnote}{\,\endnote}
\newcommand{\versionNumber}{1.3.0}

\addbibresource{back/bibliography.bib}

\NewSplitTitleTag{title}{\nameref{ch:<split-level-id>}}
\setenotez{list-name=Notes, backref=true, totoc=chapter, reset=true, split=chapter, split-title={\chaptername\ <ref> -- <title>}}

\title{L'Élégance de Bitcoin (v\versionNumber)}     % title
\author{Ludovic Lars}                       % author
\date{\today}                               % date

\hypersetup{ 
    pdftitle={\csname @title\endcsname},
    pdfauthor={\csname @author\endcsname}
}


\begin{document}



\maketitle

\thispagestyle{empty}
\doclicenseThis

\frontmatter

\include{front/foreword}
\include{front/acknowledgements}
\include{front/preface}

\tableofcontents
\addcontentsline{toc}{chapter}{Table des matières}

\mainmatter

% \part{Pourquoi ?}

\include{chapters/ch01-mythe}
\include{chapters/ch02-clivages}
\include{chapters/ch03-monnaie}
\include{chapters/ch04-adversaire}
\include{chapters/ch05-cypherpunks}
\include{chapters/ch06-cybermonnaie}

% \part{Quoi ?}

\include{chapters/ch07-propriete}
\include{chapters/ch08-confirmation}
\include{chapters/ch09-censure}
\include{chapters/ch10-changement}
\include{chapters/ch11-determination}

% \part{Comment ?}

\include{chapters/ch12-rouages}
\include{chapters/ch13-contrats}
\include{chapters/ch14-scalabilite}
\include{chapters/ch15-avenir}

\backmatter
\pagestyle{empty}

% End notes
\AtEveryEndnotesList{\footnotesize La rédaction initiale de cet ouvrage s'est terminée le 30 novembre 2023. Les traductions des textes en anglais sont celles de l'auteur, hormis quand le titre français est précisé en note. Les dates et heures sont données selon le fuseau UTC, sauf indication contraire. Des notes supplémentaires peuvent être retrouvées à la fin du document. Cette édition (v1.3.0, janvier 2025) contient de multiples corrections, de nouvelles notes et des améliorations de traduction.}
\printendnotes

% Bibliography
\nocite{*}
\printbibliography[title=Bibliographie, heading=bibintoc]

% NFT identifiers
\include{back/ordinals}

% Page notes
{\footnotesize \printnotes}

\end{document}